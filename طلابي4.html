<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <style>
        * {
            font-family: 'Tajawal', sans-serif;
        }
        
        .theme-purple {
            --primary-color: #8B5CF6;
            --secondary-color: #7C3AED;
            --accent-color: #A78BFA;
        }
        
        .theme-green {
            --primary-color: #10B981;
            --secondary-color: #059669;
            --accent-color: #34D399;
        }
        
        .theme-blue {
            --primary-color: #3B82F6;
            --secondary-color: #2563EB;
            --accent-color: #60A5FA;
        }
        
        .theme-orange {
            --primary-color: #F59E0B;
            --secondary-color: #D97706;
            --accent-color: #FBBF24;
        }
        
        .dark-mode {
            background-color: #111827 !important;
            color: #f9fafb !important;
        }
        
        .dark-mode .bg-white {
            background-color: #1f2937 !important;
            color: #f9fafb !important;
            border-color: #374151 !important;
        }
        
        .dark-mode .text-gray-800 {
            color: #f9fafb !important;
        }
        
        .dark-mode .text-gray-600 {
            color: #d1d5db !important;
        }
        
        .dark-mode .text-gray-500 {
            color: #9ca3af !important;
        }
        
        .dark-mode .border-gray-200 {
            border-color: #374151 !important;
        }
        
        .dark-mode .bg-gray-50 {
            background-color: #374151 !important;
        }
        
        .dark-mode .bg-gray-100 {
            background-color: #4b5563 !important;
        }
        
        .dark-mode input, .dark-mode select, .dark-mode textarea {
            background-color: #374151 !important;
            color: #f9fafb !important;
            border-color: #4b5563 !important;
        }
        
        .dark-mode .shadow-lg {
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5) !important;
        }
        
        .student-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        
        .counter-btn {
            transition: all 0.2s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        .counter-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .counter-btn:active {
            transform: translateY(0);
        }
        
        .active-tab {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)) !important;
            color: white !important;
        }
        
        .performance-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .performance-excellent { background: linear-gradient(135deg, #10B981, #059669); color: white; }
        .performance-very-good { background: linear-gradient(135deg, #3B82F6, #2563EB); color: white; }
        .performance-good { background: linear-gradient(135deg, #F59E0B, #D97706); color: white; }
        .performance-average { background: linear-gradient(135deg, #F97316, #EA580C); color: white; }
        .performance-weak { background: linear-gradient(135deg, #EF4444, #DC2626); color: white; }
        
        .negative-points {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
        }
        
        .positive-points {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .backup-notification {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: #10B981;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 12px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        .counter-container {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 12px;
            padding: 8px;
            box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.05);
        }
        
        .dark-mode .counter-container {
            background: linear-gradient(135deg, #374151, #4b5563);
        }
        
        .gradient-btn-plus {
            background: linear-gradient(135deg, #10B981, #059669);
            color: white;
        }
        
        .gradient-btn-minus {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
        }
        
        .tracking-card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }
        
        .dark-mode .tracking-card {
            background: #1f2937;
        }
        
        .tracking-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        .login-container {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .register-container {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        
        .dark-mode .glass-effect {
            background: rgba(31, 41, 55, 0.7);
            border: 1px solid rgba(75, 85, 99, 0.3);
        }
        
        .table-counter-cell {
            min-width: 140px;
        }
        
        .table-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }
        
        .search-box {
            background: linear-gradient(135deg, #f8fafc, #e2e8f0);
            border-radius: 10px;
            padding: 10px 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .dark-mode .search-box {
            background: linear-gradient(135deg, #374151, #4b5563);
        }
        
        .login-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }
        
        .input-glass {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        .input-glass::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }
        
        .btn-glass {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            transition: all 0.3s ease;
        }
        
        .btn-glass:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }
    </style>
</head>
<body class="theme-purple bg-gray-50 min-h-screen" dir="rtl">
    
    <!-- Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="loginScreen" class="min-h-screen flex items-center justify-center login-container p-4">
        <div class="login-card rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <div class="w-20 h-20 mx-auto mb-4 bg-white/20 rounded-2xl flex items-center justify-center">
                    <i class="fas fa-graduation-cap text-3xl text-white"></i>
                </div>
                <h1 class="text-2xl font-bold text-white">Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø§Ø¨</h1>
                <p class="text-white/80 mt-2">Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</p>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-white mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                    <input type="text" id="username" class="w-full p-3 input-glass rounded-lg focus:ring-2 focus:ring-white focus:border-transparent" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
                </div>
                <div>
                    <label class="block text-sm font-medium text-white mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="password" class="w-full p-3 input-glass rounded-lg focus:ring-2 focus:ring-white focus:border-transparent" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                </div>
                
                <button onclick="login()" class="w-full btn-glass py-3 rounded-lg font-semibold transition-all duration-300">
                    <i class="fas fa-sign-in-alt ml-2"></i>
                    ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                </button>
                
                <div class="text-center">
                    <p class="text-white/80 text-sm">Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ø­Ø³Ø§Ø¨ØŸ</p>
                    <button onclick="showRegister()" class="text-white hover:text-white/80 font-semibold text-sm mt-1">
                        Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ -->
    <div id="registerScreen" class="min-h-screen flex items-center justify-center register-container p-4 hidden">
        <div class="login-card rounded-2xl shadow-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <div class="w-20 h-20 mx-auto mb-4 bg-white/20 rounded-2xl flex items-center justify-center">
                    <i class="fas fa-user-plus text-3xl text-white"></i>
                </div>
                <h1 class="text-2xl font-bold text-white">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯</h1>
                <p class="text-white/80 mt-2">Ø§Ù†Ø´Ø¦ Ø­Ø³Ø§Ø¨Ùƒ Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</p>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-white mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
                    <input type="text" id="newUsername" class="w-full p-3 input-glass rounded-lg focus:ring-2 focus:ring-white focus:border-transparent" placeholder="Ø§Ø®ØªØ± Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…">
                </div>
                <div>
                    <label class="block text-sm font-medium text-white mb-2">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="newPassword" class="w-full p-3 input-glass rounded-lg focus:ring-2 focus:ring-white focus:border-transparent" placeholder="Ø§Ø®ØªØ± ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ±">
                </div>
                <div>
                    <label class="block text-sm font-medium text-white mb-2">ØªØ£ÙƒÙŠØ¯ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
                    <input type="password" id="confirmPassword" class="w-full p-3 input-glass rounded-lg focus:ring-2 focus:ring-white focus:border-transparent" placeholder="Ø£Ø¹Ø¯ Ø¥Ø¯Ø®Ø§Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">
                </div>
                <div>
                    <label class="block text-sm font-medium text-white mb-2">Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…</label>
                    <input type="text" id="teacherName" class="w-full p-3 input-glass rounded-lg focus:ring-2 focus:ring-white focus:border-transparent" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„">
                </div>
                
                <button onclick="register()" class="w-full btn-glass py-3 rounded-lg font-semibold transition-all duration-300">
                    <i class="fas fa-user-plus ml-2"></i>
                    Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø³Ø§Ø¨
                </button>
                
                <div class="text-center">
                    <button onclick="showLogin()" class="text-white hover:text-white/80 font-semibold text-sm">
                        â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <div id="app" class="hidden">
        <!-- Ø§Ù„Ù‡ÙŠØ¯Ø± -->
        <header class="bg-gradient-to-l from-[var(--primary-color)] to-[var(--secondary-color)] text-white shadow-lg">
            <div class="container mx-auto px-4 py-4">
                <div class="flex items-center justify-between">
                    <div class="flex items-center space-x-4 space-x-reverse">
                        <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                            <i class="fas fa-graduation-cap text-xl"></i>
                        </div>
                        <div>
                            <h1 class="text-xl font-bold">Ù†Ø¸Ø§Ù… Ù…ØªØ§Ø¨Ø¹Ø© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø·Ù„Ø§Ø¨</h1>
                            <p class="text-white/80 text-sm">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="teacherNameHeader"></span></p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3 space-x-reverse">
                        <button onclick="toggleDarkMode()" class="p-2 rounded-lg bg-white/10 hover:bg-white/20 transition">
                            <i class="fas fa-moon text-yellow-300"></i>
                        </button>
                        <div class="text-sm bg-white/20 px-3 py-1 rounded-lg">
                            <i class="fas fa-calendar-alt ml-1"></i>
                            <span id="currentDate"></span>
                        </div>
                        <button onclick="logout()" class="bg-white/10 hover:bg-white/20 px-3 py-1 rounded-lg text-sm transition">
                            <i class="fas fa-sign-out-alt ml-1"></i>
                            Ø®Ø±ÙˆØ¬
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
        <div class="bg-white shadow-lg mx-4 mt-4 rounded-xl">
            <div class="flex overflow-x-auto">
                <button onclick="showTab('groups')" class="tab-btn active-tab flex items-center space-x-2 space-x-reverse px-4 py-3 text-sm font-semibold whitespace-nowrap">
                    <i class="fas fa-users"></i>
                    <span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</span>
                </button>
                <button onclick="showTab('tracking')" class="tab-btn flex items-center space-x-2 space-x-reverse px-4 py-3 text-sm font-semibold whitespace-nowrap text-gray-600 hover:text-[var(--primary-color)]">
                    <i class="fas fa-tasks"></i>
                    <span>Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</span>
                </button>
                <button onclick="showTab('statistics')" class="tab-btn flex items-center space-x-2 space-x-reverse px-4 py-3 text-sm font-semibold whitespace-nowrap text-gray-600 hover:text-[var(--primary-color)]">
                    <i class="fas fa-chart-bar"></i>
                    <span>Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</span>
                </button>
                <button onclick="showTab('hall')" class="tab-btn flex items-center space-x-2 space-x-reverse px-4 py-3 text-sm font-semibold whitespace-nowrap text-gray-600 hover:text-[var(--primary-color)]">
                    <i class="fas fa-trophy"></i>
                    <span>Ù‚Ø§Ø¹Ø© Ø§Ù„Ø´Ø±Ù</span>
                </button>
                <button onclick="showTab('settings')" class="tab-btn flex items-center space-x-2 space-x-reverse px-4 py-3 text-sm font-semibold whitespace-nowrap text-gray-600 hover:text-[var(--primary-color)]">
                    <i class="fas fa-cogs"></i>
                    <span>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</span>
                </button>
            </div>
        </div>

        <!-- Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
        <main class="container mx-auto px-4 py-6">
            
            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª -->
            <div id="groups-tab" class="tab-content">
                <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
                        <h2 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-users ml-2 text-[var(--primary-color)]"></i>
                            Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª ÙˆØ§Ù„Ø·Ù„Ø§Ø¨
                        </h2>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="showAddGroupModal()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 space-x-reverse text-sm">
                                <i class="fas fa-layer-group"></i>
                                <span>Ø¥Ø¶Ø§ÙØ© Ù…Ø¬Ù…ÙˆØ¹Ø©</span>
                            </button>
                            <button onclick="showAddStudentModal()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 space-x-reverse text-sm">
                                <i class="fas fa-user-plus"></i>
                                <span>Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨</span>
                            </button>
                        </div>
                    </div>

                    <!-- ÙÙ„ØªØ±Ø© ÙˆØ¨Ø­Ø« Ù…ØªÙ‚Ø¯Ù… -->
                    <div class="bg-gray-50 p-4 rounded-lg mb-6">
                        <div class="flex flex-col sm:flex-row gap-4">
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 mb-1">Ø¨Ø­Ø« Ù…ØªÙ‚Ø¯Ù…</label>
                                <div class="relative">
                                    <input type="text" id="searchStudents" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ù„Ø§Ø³Ù… Ø£Ùˆ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©..." 
                                           class="w-full p-2 pr-10 border border-gray-300 rounded-lg text-sm">
                                    <i class="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                </div>
                            </div>
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 mb-1">ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</label>
                                <select id="groupFilter" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                                    <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</option>
                                </select>
                            </div>
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 mb-1">ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</label>
                                <select id="performanceFilter" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                                    <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª</option>
                                    <option value="Ù…Ù…ØªØ§Ø²">Ù…Ù…ØªØ§Ø²</option>
                                    <option value="Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹">Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹</option>
                                    <option value="Ø¬ÙŠØ¯">Ø¬ÙŠØ¯</option>
                                    <option value="Ù…ØªÙˆØ³Ø·">Ù…ØªÙˆØ³Ø·</option>
                                    <option value="Ø¶Ø¹ÙŠÙ">Ø¶Ø¹ÙŠÙ</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" id="groupsList">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù‡Ù†Ø§ -->
                    </div>
                </div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© -->
            <div id="tracking-tab" class="tab-content hidden">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
                        <h2 class="text-xl font-bold text-gray-800">
                            <i class="fas fa-tasks ml-2 text-green-500"></i>
                            Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ©
                        </h2>
                        <div class="flex flex-wrap gap-2">
                            <button onclick="showTodaySummary()" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2 space-x-reverse text-sm">
                                <i class="fas fa-chart-pie"></i>
                                <span>Ù…Ù„Ø®Øµ Ø§Ù„ÙŠÙˆÙ…</span>
                            </button>
                        </div>
                    </div>

                    <!-- ÙÙ„ØªØ±Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª ÙˆØ§Ù„Ø¨Ø­Ø« -->
                    <div class="search-box p-4 rounded-lg mb-6">
                        <div class="flex flex-col sm:flex-row gap-4">
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø·Ø§Ù„Ø¨:</label>
                                <div class="relative">
                                    <input type="text" id="searchTracking" placeholder="Ø§Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨..." 
                                           class="w-full p-2 pr-10 border border-gray-300 rounded-lg text-sm">
                                    <i class="fas fa-search absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                                </div>
                            </div>
                            <div class="flex-1">
                                <label class="block text-sm font-medium text-gray-700 mb-2">ÙÙ„ØªØ±Ø© Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©:</label>
                                <select id="trackingGroupFilter" onchange="renderTrackingTable()" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                                    <option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© -->
                    <div class="overflow-x-auto bg-white rounded-xl shadow-lg">
                        <table class="w-full min-w-4xl">
                            <thead>
                                <tr class="table-header">
                                    <th class="p-4 text-right font-semibold text-white text-sm">Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                    <th class="p-4 text-center font-semibold text-white text-sm">Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª</th>
                                    <th class="p-4 text-center font-semibold text-white text-sm">Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ©</th>
                                    <th class="p-4 text-center font-semibold text-white text-sm">Ø§Ù„Ù†Ø´Ø§Ø·</th>
                                    <th class="p-4 text-center font-semibold text-white text-sm">Ù†Ù‚Ø§Ø· âœ“</th>
                                    <th class="p-4 text-center font-semibold text-white text-sm">Ù†Ù‚Ø§Ø· âœ—</th>
                                    <th class="p-4 text-center font-semibold text-white text-sm">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                                </tr>
                            </thead>
                            <tbody id="trackingTable">
                                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù‡Ù†Ø§ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
            <div id="statistics-tab" class="tab-content hidden">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-chart-bar ml-2 text-blue-500"></i>
                        Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                        <div class="bg-gradient-to-br from-blue-500 to-blue-600 text-white p-4 rounded-xl shadow-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-blue-100 text-sm">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø§Ø¨</p>
                                    <p class="text-2xl font-bold mt-1" id="totalStudents">0</p>
                                </div>
                                <i class="fas fa-users text-xl text-blue-200"></i>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-br from-green-500 to-green-600 text-white p-4 rounded-xl shadow-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-green-100 text-sm">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</p>
                                    <p class="text-2xl font-bold mt-1" id="totalGroups">0</p>
                                </div>
                                <i class="fas fa-layer-group text-xl text-green-200"></i>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-br from-purple-500 to-purple-600 text-white p-4 rounded-xl shadow-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-purple-100 text-sm">Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· âœ“</p>
                                    <p class="text-2xl font-bold mt-1" id="highestPositivePoints">0</p>
                                </div>
                                <i class="fas fa-star text-xl text-purple-200"></i>
                            </div>
                        </div>
                        
                        <div class="bg-gradient-to-br from-orange-500 to-orange-600 text-white p-4 rounded-xl shadow-lg">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-orange-100 text-sm">Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø· âœ—</p>
                                    <p class="text-2xl font-bold mt-1" id="highestNegativePoints">0</p>
                                </div>
                                <i class="fas fa-chart-line text-xl text-orange-200"></i>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-50 rounded-xl p-6 text-center">
                        <i class="fas fa-chart-pie text-4xl text-gray-400 mb-4"></i>
                        <p class="text-gray-500">Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø®Ø·Ø·Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ© Ù‡Ù†Ø§</p>
                    </div>
                </div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ù‚Ø§Ø¹Ø© Ø§Ù„Ø´Ø±Ù -->
            <div id="hall-tab" class="tab-content hidden">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-trophy ml-2 text-yellow-500"></i>
                        Ù‚Ø§Ø¹Ø© Ø§Ù„Ø´Ø±Ù
                    </h2>
                    
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <!-- Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø£ÙˆÙ„ -->
                        <div class="bg-gradient-to-br from-yellow-400 to-yellow-600 text-white rounded-xl p-6 text-center shadow-lg">
                            <div class="w-16 h-16 mx-auto mb-3 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                                ğŸ¥‡
                            </div>
                            <h3 class="text-lg font-bold mb-1" id="firstPlace">-</h3>
                            <p class="text-yellow-100 text-sm" id="firstPoints">0 Ù†Ù‚Ø·Ø©</p>
                            <div class="mt-2 text-yellow-200 text-xs" id="firstGroup">-</div>
                            <div class="mt-1 text-yellow-200 text-xs" id="firstRatio">0% Ø¯Ù‚Ø©</div>
                        </div>

                        <!-- Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù†ÙŠ -->
                        <div class="bg-gradient-to-br from-gray-400 to-gray-600 text-white rounded-xl p-6 text-center shadow-lg">
                            <div class="w-16 h-16 mx-auto mb-3 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                                ğŸ¥ˆ
                            </div>
                            <h3 class="text-lg font-bold mb-1" id="secondPlace">-</h3>
                            <p class="text-gray-100 text-sm" id="secondPoints">0 Ù†Ù‚Ø·Ø©</p>
                            <div class="mt-2 text-gray-200 text-xs" id="secondGroup">-</div>
                            <div class="mt-1 text-gray-200 text-xs" id="secondRatio">0% Ø¯Ù‚Ø©</div>
                        </div>

                        <!-- Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù„Ø« -->
                        <div class="bg-gradient-to-br from-orange-400 to-orange-700 text-white rounded-xl p-6 text-center shadow-lg">
                            <div class="w-16 h-16 mx-auto mb-3 bg-white/20 rounded-full flex items-center justify-center text-2xl">
                                ğŸ¥‰
                            </div>
                            <h3 class="text-lg font-bold mb-1" id="thirdPlace">-</h3>
                            <p class="text-orange-100 text-sm" id="thirdPoints">0 Ù†Ù‚Ø·Ø©</p>
                            <div class="mt-2 text-orange-200 text-xs" id="thirdGroup">-</div>
                            <div class="mt-1 text-orange-200 text-xs" id="thirdRatio">0% Ø¯Ù‚Ø©</div>
                        </div>
                    </div>

                    <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØµÙ†ÙŠÙ -->
                    <div class="overflow-x-auto">
                        <table class="w-full">
                            <thead>
                                <tr class="bg-gray-50 border-b">
                                    <th class="p-3 text-right font-semibold text-gray-700 text-sm">Ø§Ù„ØªØ±ØªÙŠØ¨</th>
                                    <th class="p-3 text-right font-semibold text-gray-700 text-sm">Ø§Ù„Ø·Ø§Ù„Ø¨</th>
                                    <th class="p-3 text-right font-semibold text-gray-700 text-sm">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</th>
                                    <th class="p-3 text-center font-semibold text-gray-700 text-sm">Ù†Ù‚Ø§Ø· âœ“</th>
                                    <th class="p-3 text-center font-semibold text-gray-700 text-sm">Ù†Ù‚Ø§Ø· âœ—</th>
                                    <th class="p-3 text-center font-semibold text-gray-700 text-sm">Ø§Ù„Ø¯Ù‚Ø©</th>
                                    <th class="p-3 text-center font-semibold text-gray-700 text-sm">Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</th>
                                </tr>
                            </thead>
                            <tbody id="rankingTable">
                                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ù‡Ù†Ø§ -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- ØªØ¨ÙˆÙŠØ¨ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
            <div id="settings-tab" class="tab-content hidden">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h2 class="text-xl font-bold text-gray-800 mb-6">
                        <i class="fas fa-cogs ml-2 text-gray-500"></i>
                        Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
                    </h2>
                    
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¸Ù‡Ø± -->
                        <div class="bg-gray-50 p-4 rounded-xl border">
                            <h3 class="text-lg font-semibold mb-4 text-gray-800">
                                <i class="fas fa-palette ml-2"></i>
                                Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¸Ù‡Ø±
                            </h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø«ÙŠÙ…</label>
                                    <div class="grid grid-cols-2 gap-2">
                                        <button onclick="changeTheme('purple')" class="bg-purple-500 hover:bg-purple-600 text-white p-2 rounded-lg text-xs font-semibold">
                                            Ø§Ù„Ø¨Ù†ÙØ³Ø¬ÙŠ
                                        </button>
                                        <button onclick="changeTheme('green')" class="bg-green-500 hover:bg-green-600 text-white p-2 rounded-lg text-xs font-semibold">
                                            Ø§Ù„Ø£Ø®Ø¶Ø±
                                        </button>
                                        <button onclick="changeTheme('blue')" class="bg-blue-500 hover:bg-blue-600 text-white p-2 rounded-lg text-xs font-semibold">
                                            Ø§Ù„Ø£Ø²Ø±Ù‚
                                        </button>
                                        <button onclick="changeTheme('orange')" class="bg-orange-500 hover:bg-orange-600 text-white p-2 rounded-lg text-xs font-semibold">
                                            Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ
                                        </button>
                                    </div>
                                </div>
                                <div class="flex items-center justify-between p-2 bg-white rounded-lg">
                                    <span class="text-gray-700 font-medium text-sm">Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</span>
                                    <label class="relative inline-flex items-center cursor-pointer">
                                        <input type="checkbox" id="darkModeToggle" class="sr-only peer">
                                        <div class="w-10 h-5 bg-gray-200 peer-focus:ring-2 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"></div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£ÙˆØ²Ø§Ù† -->
                        <div class="bg-gray-50 p-4 rounded-xl border">
                            <h3 class="text-lg font-semibold mb-4 text-gray-800">
                                <i class="fas fa-weight-scale ml-2"></i>
                                Ø£ÙˆØ²Ø§Ù† Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
                            </h3>
                            <div class="space-y-3">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Ù†Ù‚Ø§Ø· Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª (Ù„ÙƒÙ„ âœ“)</label>
                                    <input type="number" id="homeworkWeight" value="1" min="1" max="10" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Ù†Ù‚Ø§Ø· Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© (Ù„ÙƒÙ„ âœ“)</label>
                                    <input type="number" id="participationWeight" value="1" min="1" max="10" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Ù†Ù‚Ø§Ø· Ø§Ù„Ù†Ø´Ø§Ø· (Ù„ÙƒÙ„ âœ“)</label>
                                    <input type="number" id="activityWeight" value="1" min="1" max="10" class="w-full p-2 border border-gray-300 rounded-lg text-sm">
                                </div>
                                <button onclick="saveWeights()" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg font-semibold text-sm mt-2">
                                    <i class="fas fa-save ml-1"></i>
                                    Ø­ÙØ¸ Ø§Ù„Ø£ÙˆØ²Ø§Ù†
                                </button>
                            </div>
                        </div>

                        <!-- Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
                        <div class="bg-gray-50 p-4 rounded-xl border lg:col-span-2">
                            <h3 class="text-lg font-semibold mb-4 text-gray-800">
                                <i class="fas fa-database ml-2"></i>
                                Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                            </h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3">
                                <button onclick="importFromExcel()" class="bg-white hover:bg-gray-50 text-gray-800 py-3 rounded-lg font-semibold border border-gray-200 shadow-sm text-sm flex items-center justify-center space-x-1 space-x-reverse">
                                    <i class="fas fa-file-import text-green-500"></i>
                                    <span>Ø§Ø³ØªÙŠØ±Ø§Ø¯</span>
                                </button>
                                
                                <button onclick="exportToExcel()" class="bg-white hover:bg-gray-50 text-gray-800 py-3 rounded-lg font-semibold border border-gray-200 shadow-sm text-sm flex items-center justify-center space-x-1 space-x-reverse">
                                    <i class="fas fa-file-excel text-green-500"></i>
                                    <span>Excel</span>
                                </button>
                                
                                <button onclick="exportToPDF()" class="bg-white hover:bg-gray-50 text-gray-800 py-3 rounded-lg font-semibold border border-gray-200 shadow-sm text-sm flex items-center justify-center space-x-1 space-x-reverse">
                                    <i class="fas fa-file-pdf text-red-500"></i>
                                    <span>PDF</span>
                                </button>
                                
                                <button onclick="showBackupManager()" class="bg-white hover:bg-gray-50 text-gray-800 py-3 rounded-lg font-semibold border border-gray-200 shadow-sm text-sm flex items-center justify-center space-x-1 space-x-reverse">
                                    <i class="fas fa-download text-yellow-500"></i>
                                    <span>Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</span>
                                </button>
                            </div>
                            
                            <div class="mt-4 p-3 bg-red-50 border border-red-200 rounded-lg">
                                <button onclick="resetData()" class="w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg font-semibold text-sm flex items-center justify-center space-x-1 space-x-reverse">
                                    <i class="fas fa-trash ml-1"></i>
                                    <span>Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
                                </button>
                                <p class="text-red-600 text-xs mt-1 text-center">âš ï¸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Ø§Ù„ÙÙˆØªØ± -->
        <footer class="bg-gray-800 text-white py-3 mt-8">
            <div class="container mx-auto px-4 text-center">
                <p class="text-gray-400 text-xs flex items-center justify-center space-x-1 space-x-reverse">
                    <i class="fas fa-code text-blue-400"></i>
                    <span>ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© Ø­Ø³Ù† Ø§Ù„Ù…Ø­Ù…Ø¯</span>
                </p>
            </div>
        </footer>
    </div>

    <!-- Ø§Ù„Ù…ÙˆØ¯Ø§Ù„Ø§Øª -->
    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø¥Ø¶Ø§ÙØ© Ù…Ø¬Ù…ÙˆØ¹Ø© -->
    <div id="addGroupModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl p-6 w-96 mx-4 shadow-2xl">
            <h3 class="text-lg font-bold text-gray-800 mb-4 text-center">Ø¥Ø¶Ø§ÙØ© Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</label>
                    <input type="text" id="groupName" class="w-full p-3 border border-gray-300 rounded-lg text-sm" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ù„ÙˆÙ† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</label>
                    <div class="flex justify-center space-x-2 space-x-reverse">
                        <button onclick="setGroupColor('bg-gradient-to-r from-blue-500 to-blue-600')" class="w-8 h-8 rounded-lg bg-gradient-to-r from-blue-500 to-blue-600 border border-gray-300"></button>
                        <button onclick="setGroupColor('bg-gradient-to-r from-green-500 to-green-600')" class="w-8 h-8 rounded-lg bg-gradient-to-r from-green-500 to-green-600 border border-gray-300"></button>
                        <button onclick="setGroupColor('bg-gradient-to-r from-purple-500 to-purple-600')" class="w-8 h-8 rounded-lg bg-gradient-to-r from-purple-500 to-purple-600 border border-gray-300"></button>
                        <button onclick="setGroupColor('bg-gradient-to-r from-red-500 to-red-600')" class="w-8 h-8 rounded-lg bg-gradient-to-r from-red-500 to-red-600 border border-gray-300"></button>
                    </div>
                </div>
            </div>
            <div class="flex space-x-2 space-x-reverse mt-6">
                <button onclick="hideAddGroupModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-semibold text-sm">Ø¥Ù„ØºØ§Ø¡</button>
                <button onclick="addGroup()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg font-semibold text-sm">Ø¥Ø¶Ø§ÙØ©</button>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ -->
    <div id="addStudentModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl p-6 w-96 mx-4 shadow-2xl">
            <h3 class="text-lg font-bold text-gray-800 mb-4 text-center">Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</label>
                    <input type="text" id="studentName" class="w-full p-3 border border-gray-300 rounded-lg text-sm" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</label>
                    <select id="studentGroup" class="w-full p-3 border border-gray-300 rounded-lg text-sm">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù‡Ù†Ø§ -->
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ù„ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨</label>
                    <div class="flex justify-center space-x-2 space-x-reverse">
                        <button onclick="setStudentColor('bg-gradient-to-r from-blue-400 to-blue-500')" class="w-8 h-8 rounded-full bg-gradient-to-r from-blue-400 to-blue-500 border border-gray-300"></button>
                        <button onclick="setStudentColor('bg-gradient-to-r from-green-400 to-green-500')" class="w-8 h-8 rounded-full bg-gradient-to-r from-green-400 to-green-500 border border-gray-300"></button>
                        <button onclick="setStudentColor('bg-gradient-to-r from-purple-400 to-purple-500')" class="w-8 h-8 rounded-full bg-gradient-to-r from-purple-400 to-purple-500 border border-gray-300"></button>
                        <button onclick="setStudentColor('bg-gradient-to-r from-pink-400 to-pink-500')" class="w-8 h-8 rounded-full bg-gradient-to-r from-pink-400 to-pink-500 border border-gray-300"></button>
                    </div>
                </div>
            </div>
            <div class="flex space-x-2 space-x-reverse mt-6">
                <button onclick="hideAddStudentModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-semibold text-sm">Ø¥Ù„ØºØ§Ø¡</button>
                <button onclick="addStudent()" class="flex-1 bg-green-500 hover:bg-green-600 text-white py-2 rounded-lg font-semibold text-sm">Ø¥Ø¶Ø§ÙØ©</button>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ -->
    <div id="backupModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl p-6 w-96 mx-4 shadow-2xl">
            <h3 class="text-lg font-bold text-gray-800 mb-4 text-center">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ</h3>
            <div class="space-y-4">
                <div class="text-center">
                    <i class="fas fa-database text-4xl text-blue-500 mb-2"></i>
                    <p class="text-sm text-gray-600">Ø¥Ø¯Ø§Ø±Ø© Ù†Ø³Ø®Ùƒ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
                </div>
                
                <button onclick="createBackup()" class="w-full bg-green-500 hover:bg-green-600 text-white py-3 rounded-lg font-semibold text-sm flex items-center justify-center space-x-2 space-x-reverse">
                    <i class="fas fa-plus"></i>
                    <span>Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¬Ø¯ÙŠØ¯Ø©</span>
                </button>
                
                <button onclick="autoBackupToggle()" class="w-full bg-blue-500 hover:bg-blue-600 text-white py-3 rounded-lg font-semibold text-sm flex items-center justify-center space-x-2 space-x-reverse">
                    <i class="fas fa-robot"></i>
                    <span id="autoBackupText">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ</span>
                </button>
                
                <div class="border-t pt-4">
                    <h4 class="font-semibold text-gray-700 mb-2">Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©:</h4>
                    <div id="backupList" class="max-h-40 overflow-y-auto space-y-2">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù‡Ù†Ø§ -->
                    </div>
                </div>
            </div>
            <div class="flex space-x-2 space-x-reverse mt-6">
                <button onclick="hideBackupModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-semibold text-sm">Ø¥ØºÙ„Ø§Ù‚</button>
            </div>
        </div>
    </div>

    <!-- Ù…ÙˆØ¯Ø§Ù„ ØªØ­Ø±ÙŠØ± Ø§Ù„Ø·Ø§Ù„Ø¨ -->
    <div id="editStudentModal" class="fixed inset-0 bg-black/50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-xl p-6 w-96 mx-4 shadow-2xl">
            <h3 class="text-lg font-bold text-gray-800 mb-4 text-center">ØªØ­Ø±ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</label>
                    <input type="text" id="editStudentName" class="w-full p-3 border border-gray-300 rounded-lg text-sm">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</label>
                    <select id="editStudentGroup" class="w-full p-3 border border-gray-300 rounded-lg text-sm">
                        <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù‡Ù†Ø§ -->
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Ù„ÙˆÙ† Ø§Ù„Ø·Ø§Ù„Ø¨</label>
                    <div class="flex justify-center space-x-2 space-x-reverse">
                        <button onclick="setEditStudentColor('bg-gradient-to-r from-blue-400 to-blue-500')" class="w-8 h-8 rounded-full bg-gradient-to-r from-blue-400 to-blue-500 border border-gray-300"></button>
                        <button onclick="setEditStudentColor('bg-gradient-to-r from-green-400 to-green-500')" class="w-8 h-8 rounded-full bg-gradient-to-r from-green-400 to-green-500 border border-gray-300"></button>
                        <button onclick="setEditStudentColor('bg-gradient-to-r from-purple-400 to-purple-500')" class="w-8 h-8 rounded-full bg-gradient-to-r from-purple-400 to-purple-500 border border-gray-300"></button>
                        <button onclick="setEditStudentColor('bg-gradient-to-r from-pink-400 to-pink-500')" class="w-8 h-8 rounded-full bg-gradient-to-r from-pink-400 to-pink-500 border border-gray-300"></button>
                    </div>
                </div>
                <div class="border-t pt-4">
                    <h4 class="font-semibold text-gray-700 mb-2">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯:</h4>
                    <button onclick="resetStudentCounters()" class="w-full bg-red-500 hover:bg-red-600 text-white py-2 rounded-lg font-semibold text-sm">
                        <i class="fas fa-undo ml-1"></i>
                        Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ø¯Ø§Ø¯
                    </button>
                </div>
            </div>
            <div class="flex space-x-2 space-x-reverse mt-6">
                <button onclick="hideEditStudentModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-semibold text-sm">Ø¥Ù„ØºØ§Ø¡</button>
                <button onclick="saveStudentChanges()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 rounded-lg font-semibold text-sm">Ø­ÙØ¸</button>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ø³ÙƒØ±ÙŠØ¨Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <script>
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        let appData = {
            users: {},
            currentUser: null,
            settings: {
                theme: 'purple',
                darkMode: false,
                autoBackup: true
            },
            backups: []
        };

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
        let currentUserData = {
            groups: [],
            students: [],
            counters: {},
            userSettings: {
                homeworkWeight: 1,
                participationWeight: 1,
                activityWeight: 1
            }
        };

        // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
        let currentGroupColor = 'bg-gradient-to-r from-blue-500 to-blue-600';
        let currentStudentColor = 'bg-gradient-to-r from-blue-400 to-blue-500';
        let currentEditStudentColor = 'bg-gradient-to-r from-blue-400 to-blue-500';
        let backupInterval;
        let editingStudentId = null;

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            loadData();
            applyTheme();
            updateDate();
            setupEventListeners();
            checkAuthentication();
            startAutoBackup();
        }

        function setupEventListeners() {
            // Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±Ø©
            document.getElementById('searchStudents').addEventListener('input', filterStudents);
            document.getElementById('groupFilter').addEventListener('change', filterStudents);
            document.getElementById('performanceFilter').addEventListener('change', filterStudents);
            document.getElementById('darkModeToggle').addEventListener('change', toggleDarkMode);
            
            // Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©
            document.getElementById('searchTracking').addEventListener('input', renderTrackingTable);
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
        function startAutoBackup() {
            if (backupInterval) clearInterval(backupInterval);
            
            backupInterval = setInterval(() => {
                if (appData.settings.autoBackup && appData.currentUser) {
                    createBackup(true); // Ù†Ø³Ø® ØªÙ„Ù‚Ø§Ø¦ÙŠ
                }
            }, 30 * 60 * 1000); // ÙƒÙ„ 30 Ø¯Ù‚ÙŠÙ‚Ø©
        }

        function createBackup(isAuto = false) {
            const backup = {
                id: Date.now().toString(),
                timestamp: new Date().toISOString(),
                data: JSON.parse(JSON.stringify(currentUserData)),
                isAuto: isAuto
            };
            
            appData.backups.unshift(backup);
            
            // Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø¢Ø®Ø± 10 Ù†Ø³Ø® ÙÙ‚Ø·
            if (appData.backups.length > 10) {
                appData.backups = appData.backups.slice(0, 10);
            }
            
            saveData();
            
            if (!isAuto) {
                Swal.fire({
                    icon: 'success',
                    title: 'ØªÙ… Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ',
                    text: 'ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                updateBackupList();
            }
        }

        function showBackupManager() {
            document.getElementById('backupModal').classList.remove('hidden');
            updateBackupList();
            updateAutoBackupButton();
        }

        function hideBackupModal() {
            document.getElementById('backupModal').classList.add('hidden');
        }

        function updateBackupList() {
            const backupList = document.getElementById('backupList');
            backupList.innerHTML = '';
            
            if (appData.backups.length === 0) {
                backupList.innerHTML = '<p class="text-gray-500 text-sm text-center">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©</p>';
                return;
            }
            
            appData.backups.forEach(backup => {
                const date = new Date(backup.timestamp);
                const backupItem = document.createElement('div');
                backupItem.className = 'flex items-center justify-between p-2 bg-gray-50 rounded-lg';
                backupItem.innerHTML = `
                    <div class="flex items-center space-x-2 space-x-reverse">
                        <i class="fas fa-database ${backup.isAuto ? 'text-blue-500' : 'text-green-500'}"></i>
                        <div>
                            <p class="text-sm font-medium">${date.toLocaleDateString('ar-SA')}</p>
                            <p class="text-xs text-gray-500">${date.toLocaleTimeString('ar-SA')}</p>
                        </div>
                    </div>
                    <div class="flex space-x-1 space-x-reverse">
                        <button onclick="restoreBackup('${backup.id}')" class="text-blue-500 hover:text-blue-700 text-sm">
                            <i class="fas fa-undo"></i>
                        </button>
                        <button onclick="downloadBackup('${backup.id}')" class="text-green-500 hover:text-green-700 text-sm">
                            <i class="fas fa-download"></i>
                        </button>
                        <button onclick="deleteBackup('${backup.id}')" class="text-red-500 hover:text-red-700 text-sm">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                backupList.appendChild(backupItem);
            });
        }

        function restoreBackup(backupId) {
            const backup = appData.backups.find(b => b.id === backupId);
            if (!backup) return;
            
            Swal.fire({
                title: 'Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©',
                text: 'Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø©ØŸ Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Ù†Ø¹Ù…ØŒ Ø§Ø³ØªØ¹Ø§Ø¯Ø©',
                cancelButtonText: 'Ø¥Ù„ØºØ§Ø¡'
            }).then((result) => {
                if (result.isConfirmed) {
                    currentUserData = JSON.parse(JSON.stringify(backup.data));
                    autoSave();
                    renderGroups();
                    renderTrackingTable();
                    updateStatistics();
                    updateHallOfFame();
                    Swal.fire('ØªÙ… Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©', 'ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                }
            });
        }

        function downloadBackup(backupId) {
            const backup = appData.backups.find(b => b.id === backupId);
            if (!backup) return;
            
            const dataStr = JSON.stringify(backup, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `student_tracker_backup_${backupId}.json`;
            link.click();
        }

        function deleteBackup(backupId) {
            Swal.fire({
                title: 'Ø­Ø°Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©',
                text: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©ØŸ',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù',
                cancelButtonText: 'Ø¥Ù„ØºØ§Ø¡'
            }).then((result) => {
                if (result.isConfirmed) {
                    appData.backups = appData.backups.filter(backup => backup.id !== backupId);
                    saveData();
                    updateBackupList();
                    Swal.fire('ØªÙ… Ø§Ù„Ø­Ø°Ù', 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                }
            });
        }

        function autoBackupToggle() {
            appData.settings.autoBackup = !appData.settings.autoBackup;
            updateAutoBackupButton();
            saveData();
            
            if (appData.settings.autoBackup) {
                startAutoBackup();
                Swal.fire({
                    icon: 'success',
                    title: 'ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ',
                    text: 'Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙƒÙ„ 30 Ø¯Ù‚ÙŠÙ‚Ø©',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
            } else {
                if (backupInterval) clearInterval(backupInterval);
                Swal.fire({
                    icon: 'info',
                    title: 'ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ',
                    text: 'Ù„Ù† ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
            }
        }

        function updateAutoBackupButton() {
            const button = document.getElementById('autoBackupText');
            button.textContent = appData.settings.autoBackup ? 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ' : 'ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†Ø³Ø® Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ';
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© - ØªÙ… Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø¨Ø´ÙƒÙ„ Ù†Ù‡Ø§Ø¦ÙŠ
        function checkAuthentication() {
            if (appData.currentUser) {
                showApp();
            } else {
                showLogin();
            }
        }

        function showLogin() {
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('app').classList.add('hidden');
        }

        function showRegister() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.remove('hidden');
        }

        function showApp() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('registerScreen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            
            // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            if (appData.currentUser && appData.users[appData.currentUser]) {
                currentUserData = appData.users[appData.currentUser];
                document.getElementById('teacherNameHeader').textContent = currentUserData.teacherName || appData.currentUser;
                renderGroups();
                renderTrackingTable();
                updateStatistics();
                updateHallOfFame();
                loadWeights();
                updateGroupFilters();
            }
        }

        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            if (!username || !password) {
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            if (appData.users[username] && appData.users[username].password === password) {
                appData.currentUser = username;
                currentUserData = appData.users[username]; // ØªØ£ÙƒØ¯ Ù…Ù† ØªØ¹ÙŠÙŠÙ† currentUserData
                saveData();
                showApp();
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
            }
        }

        function register() {
            const username = document.getElementById('newUsername').value.trim();
            const password = document.getElementById('newPassword').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();
            const teacherName = document.getElementById('teacherName').value.trim();
            
            if (!username || !password || !confirmPassword || !teacherName) {
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                return;
            }
            
            if (password !== confirmPassword) {
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± Ù…ØªØ·Ø§Ø¨Ù‚Ø©',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                return;
            }
            
            if (appData.users[username]) {
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ø§Ù‹',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                return;
            }
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨ Ø¬Ø¯ÙŠØ¯
            appData.users[username] = {
                password: password,
                teacherName: teacherName,
                groups: [],
                students: [],
                counters: {},
                userSettings: {
                    homeworkWeight: 1,
                    participationWeight: 1,
                    activityWeight: 1
                }
            };
            
            appData.currentUser = username;
            currentUserData = appData.users[username]; // ØªØ£ÙƒØ¯ Ù…Ù† ØªØ¹ÙŠÙŠÙ† currentUserData
            saveData();
            showApp();
        }

        function logout() {
            Swal.fire({
                title: 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø®Ø±ÙˆØ¬',
                text: 'Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ØŸ',
                icon: 'question',
                showCancelButton: true,
                confirmButtonText: 'Ù†Ø¹Ù…ØŒ Ø®Ø±ÙˆØ¬',
                cancelButtonText: 'Ø¥Ù„ØºØ§Ø¡'
            }).then((result) => {
                if (result.isConfirmed) {
                    appData.currentUser = null;
                    saveData();
                    showLogin();
                }
            });
        }

        // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª ÙˆØ§Ù„Ø·Ù„Ø§Ø¨
        function showAddGroupModal() {
            document.getElementById('addGroupModal').classList.remove('hidden');
            document.getElementById('groupName').value = '';
        }

        function hideAddGroupModal() {
            document.getElementById('addGroupModal').classList.add('hidden');
        }

        function setGroupColor(color) {
            currentGroupColor = color;
        }

        function addGroup() {
            const groupName = document.getElementById('groupName').value.trim();
            
            if (!groupName) {
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                return;
            }
            
            const newGroup = {
                id: Date.now().toString(),
                name: groupName,
                color: currentGroupColor,
                createdAt: new Date().toISOString()
            };
            
            currentUserData.groups.push(newGroup);
            autoSave();
            renderGroups();
            updateGroupFilters();
            hideAddGroupModal();
            
            Swal.fire({
                icon: 'success',
                title: 'ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©',
                text: 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¨Ù†Ø¬Ø§Ø­',
                confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
            });
        }

        function showAddStudentModal() {
            document.getElementById('addStudentModal').classList.remove('hidden');
            document.getElementById('studentName').value = '';
            
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª
            const groupSelect = document.getElementById('studentGroup');
            groupSelect.innerHTML = '';
            
            currentUserData.groups.forEach(group => {
                const option = document.createElement('option');
                option.value = group.id;
                option.textContent = group.name;
                groupSelect.appendChild(option);
            });
        }

        function hideAddStudentModal() {
            document.getElementById('addStudentModal').classList.add('hidden');
        }

        function setStudentColor(color) {
            currentStudentColor = color;
        }

        function addStudent() {
            const studentName = document.getElementById('studentName').value.trim();
            const groupId = document.getElementById('studentGroup').value;
            
            if (!studentName) {
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                return;
            }
            
            if (!groupId) {
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¬Ù…ÙˆØ¹Ø© Ù„Ù„Ø·Ø§Ù„Ø¨',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                return;
            }
            
            const group = currentUserData.groups.find(g => g.id === groupId);
            
            const newStudent = {
                id: Date.now().toString(),
                name: studentName,
                groupId: groupId,
                groupName: group.name,
                color: currentStudentColor,
                createdAt: new Date().toISOString(),
                counters: {
                    homework: { positive: 0, negative: 0 },
                    participation: { positive: 0, negative: 0 },
                    activity: { positive: 0, negative: 0 }
                }
            };
            
            currentUserData.students.push(newStudent);
            autoSave();
            renderGroups();
            renderTrackingTable();
            hideAddStudentModal();
            
            Swal.fire({
                icon: 'success',
                title: 'ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©',
                text: 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­',
                confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
            });
        }

        function deleteGroup(groupId) {
            Swal.fire({
                title: 'Ø­Ø°Ù Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©',
                text: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©ØŸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…Ø±ØªØ¨Ø·ÙŠÙ† Ø¨Ù‡Ø§.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù',
                cancelButtonText: 'Ø¥Ù„ØºØ§Ø¡'
            }).then((result) => {
                if (result.isConfirmed) {
                    currentUserData.groups = currentUserData.groups.filter(g => g.id !== groupId);
                    currentUserData.students = currentUserData.students.filter(s => s.groupId !== groupId);
                    autoSave();
                    renderGroups();
                    renderTrackingTable();
                    updateGroupFilters();
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'ØªÙ… Ø§Ù„Ø­Ø°Ù',
                        text: 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© ÙˆØ¬Ù…ÙŠØ¹ Ø·Ù„Ø§Ø¨Ù‡Ø§',
                        confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                    });
                }
            });
        }

        function deleteStudent(studentId) {
            Swal.fire({
                title: 'Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨',
                text: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ØŸ',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Ù†Ø¹Ù…ØŒ Ø§Ø­Ø°Ù',
                cancelButtonText: 'Ø¥Ù„ØºØ§Ø¡'
            }).then((result) => {
                if (result.isConfirmed) {
                    currentUserData.students = currentUserData.students.filter(s => s.id !== studentId);
                    autoSave();
                    renderGroups();
                    renderTrackingTable();
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'ØªÙ… Ø§Ù„Ø­Ø°Ù',
                        text: 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­',
                        confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                    });
                }
            });
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª
        function renderGroups() {
            const groupsList = document.getElementById('groupsList');
            groupsList.innerHTML = '';
            
            if (currentUserData.groups.length === 0) {
                groupsList.innerHTML = `
                    <div class="col-span-3 text-center py-8">
                        <i class="fas fa-users text-4xl text-gray-300 mb-4"></i>
                        <p class="text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ø¨Ø¹Ø¯</p>
                        <button onclick="showAddGroupModal()" class="mt-4 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                            Ø¥Ø¶Ø§ÙØ© Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø©
                        </button>
                    </div>
                `;
                return;
            }
            
            currentUserData.groups.forEach(group => {
                const groupStudents = currentUserData.students.filter(s => s.groupId === group.id);
                
                const groupCard = document.createElement('div');
                groupCard.className = 'bg-white rounded-xl shadow-lg overflow-hidden fade-in';
                groupCard.innerHTML = `
                    <div class="${group.color} text-white p-4">
                        <div class="flex justify-between items-center">
                            <h3 class="font-bold text-lg">${group.name}</h3>
                            <div class="flex space-x-1 space-x-reverse">
                                <button onclick="editGroup('${group.id}')" class="p-1 bg-white/20 hover:bg-white/30 rounded-lg">
                                    <i class="fas fa-edit text-xs"></i>
                                </button>
                                <button onclick="deleteGroup('${group.id}')" class="p-1 bg-white/20 hover:bg-white/30 rounded-lg">
                                    <i class="fas fa-trash text-xs"></i>
                                </button>
                            </div>
                        </div>
                        <p class="text-white/80 text-sm mt-1">${groupStudents.length} Ø·Ø§Ù„Ø¨</p>
                    </div>
                    <div class="p-4">
                        ${groupStudents.length > 0 ? `
                            <div class="space-y-3">
                                ${groupStudents.map(student => `
                                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded-lg">
                                        <div class="flex items-center space-x-2 space-x-reverse">
                                            <div class="student-avatar ${student.color}">
                                                ${student.name.charAt(0)}
                                            </div>
                                            <div>
                                                <p class="font-medium text-sm">${student.name}</p>
                                                <div class="flex space-x-1 space-x-reverse mt-1">
                                                    <span class="performance-badge ${getPerformanceClass(student)}">
                                                        ${calculatePerformance(student)}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex space-x-1 space-x-reverse">
                                            <button onclick="editStudent('${student.id}')" class="text-blue-500 hover:text-blue-700">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button onclick="deleteStudent('${student.id}')" class="text-red-500 hover:text-red-700">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : `
                            <div class="text-center py-4">
                                <i class="fas fa-user-slash text-2xl text-gray-300 mb-2"></i>
                                <p class="text-gray-500 text-sm">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø§Ø¨ ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©</p>
                                <button onclick="showAddStudentModal()" class="mt-2 text-blue-500 hover:text-blue-700 text-sm">
                                    Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨
                                </button>
                            </div>
                        `}
                    </div>
                `;
                groupsList.appendChild(groupCard);
            });
        }

        // Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„ØªØ±Ø©
        function filterStudents() {
            const searchTerm = document.getElementById('searchStudents').value.toLowerCase();
            const groupFilter = document.getElementById('groupFilter').value;
            const performanceFilter = document.getElementById('performanceFilter').value;
            
            const groupsList = document.getElementById('groupsList');
            groupsList.innerHTML = '';
            
            let filteredGroups = [...currentUserData.groups];
            
            if (groupFilter !== 'all') {
                filteredGroups = filteredGroups.filter(group => group.id === groupFilter);
            }
            
            filteredGroups.forEach(group => {
                let groupStudents = currentUserData.students.filter(s => s.groupId === group.id);
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø«
                if (searchTerm) {
                    groupStudents = groupStudents.filter(student => 
                        student.name.toLowerCase().includes(searchTerm) || 
                        group.name.toLowerCase().includes(searchTerm)
                    );
                }
                
                // ØªØ·Ø¨ÙŠÙ‚ ÙÙ„ØªØ±Ø© Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
                if (performanceFilter !== 'all') {
                    groupStudents = groupStudents.filter(student => 
                        calculatePerformance(student) === performanceFilter
                    );
                }
                
                if (groupStudents.length === 0 && groupFilter !== 'all') {
                    return; // ØªØ®Ø·ÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø¨Ù‡Ø§ Ø·Ù„Ø§Ø¨ Ø¨Ø¹Ø¯ Ø§Ù„ØªØµÙÙŠØ©
                }
                
                const groupCard = document.createElement('div');
                groupCard.className = 'bg-white rounded-xl shadow-lg overflow-hidden fade-in';
                groupCard.innerHTML = `
                    <div class="${group.color} text-white p-4">
                        <div class="flex justify-between items-center">
                            <h3 class="font-bold text-lg">${group.name}</h3>
                            <div class="flex space-x-1 space-x-reverse">
                                <button onclick="editGroup('${group.id}')" class="p-1 bg-white/20 hover:bg-white/30 rounded-lg">
                                    <i class="fas fa-edit text-xs"></i>
                                </button>
                                <button onclick="deleteGroup('${group.id}')" class="p-1 bg-white/20 hover:bg-white/30 rounded-lg">
                                    <i class="fas fa-trash text-xs"></i>
                                </button>
                            </div>
                        </div>
                        <p class="text-white/80 text-sm mt-1">${groupStudents.length} Ø·Ø§Ù„Ø¨</p>
                    </div>
                    <div class="p-4">
                        ${groupStudents.length > 0 ? `
                            <div class="space-y-3">
                                ${groupStudents.map(student => `
                                    <div class="flex items-center justify-between p-2 bg-gray-50 rounded-lg">
                                        <div class="flex items-center space-x-2 space-x-reverse">
                                            <div class="student-avatar ${student.color}">
                                                ${student.name.charAt(0)}
                                            </div>
                                            <div>
                                                <p class="font-medium text-sm">${student.name}</p>
                                                <div class="flex space-x-1 space-x-reverse mt-1">
                                                    <span class="performance-badge ${getPerformanceClass(student)}">
                                                        ${calculatePerformance(student)}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex space-x-1 space-x-reverse">
                                            <button onclick="editStudent('${student.id}')" class="text-blue-500 hover:text-blue-700">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button onclick="deleteStudent('${student.id}')" class="text-red-500 hover:text-red-700">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : `
                            <div class="text-center py-4">
                                <i class="fas fa-user-slash text-2xl text-gray-300 mb-2"></i>
                                <p class="text-gray-500 text-sm">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ Ù„Ù„Ø¨Ø­Ø«</p>
                            </div>
                        `}
                    </div>
                `;
                groupsList.appendChild(groupCard);
            });
            
            if (groupsList.children.length === 0) {
                groupsList.innerHTML = `
                    <div class="col-span-3 text-center py-8">
                        <i class="fas fa-search text-4xl text-gray-300 mb-4"></i>
                        <p class="text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†ØªØ§Ø¦Ø¬ ØªØ·Ø§Ø¨Ù‚ Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ø¨Ø­Ø«</p>
                    </div>
                `;
            }
        }

        function updateGroupFilters() {
            const groupFilter = document.getElementById('groupFilter');
            const trackingGroupFilter = document.getElementById('trackingGroupFilter');
            
            // ØªØ­Ø¯ÙŠØ« ÙÙ„ØªØ± Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª
            groupFilter.innerHTML = '<option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</option>';
            trackingGroupFilter.innerHTML = '<option value="all">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</option>';
            
            currentUserData.groups.forEach(group => {
                const option1 = document.createElement('option');
                option1.value = group.id;
                option1.textContent = group.name;
                groupFilter.appendChild(option1);
                
                const option2 = document.createElement('option');
                option2.value = group.id;
                option2.textContent = group.name;
                trackingGroupFilter.appendChild(option2);
            });
        }

        // Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ÙŠÙˆÙ…ÙŠØ© - ØªØµÙ…ÙŠÙ… Ø¬Ø¯ÙˆÙ„ Ù…Ø­Ø³Ù†
        function renderTrackingTable() {
            const trackingTable = document.getElementById('trackingTable');
            trackingTable.innerHTML = '';
            
            const groupFilter = document.getElementById('trackingGroupFilter').value;
            const searchTerm = document.getElementById('searchTracking').value.toLowerCase();
            
            let students = [...currentUserData.students];
            
            if (groupFilter !== 'all') {
                students = students.filter(s => s.groupId === groupFilter);
            }
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¨Ø­Ø«
            if (searchTerm) {
                students = students.filter(student => 
                    student.name.toLowerCase().includes(searchTerm)
                );
            }
            
            // ØªØ±ØªÙŠØ¨ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø£Ø¨Ø¬Ø¯ÙŠÙ‹Ø§ Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
            students.sort((a, b) => a.name.localeCompare(b.name, 'ar'));
            
            if (students.length === 0) {
                trackingTable.innerHTML = `
                    <tr>
                        <td colspan="7" class="p-8 text-center text-gray-500">
                            <i class="fas fa-users text-3xl mb-2"></i>
                            <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¹Ø±Ø¶</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            students.forEach(student => {
                const group = currentUserData.groups.find(g => g.id === student.groupId);
                const totalPositive = calculateTotalPositivePoints(student);
                const totalNegative = calculateTotalNegativePoints(student);
                const performance = calculatePerformance(student);
                
                const row = document.createElement('tr');
                row.className = 'border-b hover:bg-gray-50 fade-in';
                row.innerHTML = `
                    <td class="p-4">
                        <div class="flex items-center space-x-3 space-x-reverse">
                            <div class="student-avatar ${student.color}">
                                ${student.name.charAt(0)}
                            </div>
                            <div>
                                <p class="font-bold text-gray-800">${student.name}</p>
                                <p class="text-gray-500 text-xs">${group ? group.name : 'Ø¨Ø¯ÙˆÙ† Ù…Ø¬Ù…ÙˆØ¹Ø©'}</p>
                            </div>
                        </div>
                    </td>
                    
                    <!-- Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª -->
                    <td class="p-4 text-center table-counter-cell">
                        <div class="flex justify-center items-center space-x-4 space-x-reverse">
                            <div class="text-center">
                                <button onclick="updateCounter('${student.id}', 'homework', 'positive', 1)" class="counter-btn gradient-btn-plus w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-lg mb-1">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <span class="font-bold text-lg text-green-600">${student.counters.homework.positive}</span>
                            </div>
                            <div class="text-center">
                                <button onclick="updateCounter('${student.id}', 'homework', 'negative', 1)" class="counter-btn gradient-btn-minus w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-lg mb-1">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="font-bold text-lg text-red-600">${student.counters.homework.negative}</span>
                            </div>
                        </div>
                    </td>
                    
                    <!-- Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© -->
                    <td class="p-4 text-center table-counter-cell">
                        <div class="flex justify-center items-center space-x-4 space-x-reverse">
                            <div class="text-center">
                                <button onclick="updateCounter('${student.id}', 'participation', 'positive', 1)" class="counter-btn gradient-btn-plus w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-lg mb-1">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <span class="font-bold text-lg text-green-600">${student.counters.participation.positive}</span>
                            </div>
                            <div class="text-center">
                                <button onclick="updateCounter('${student.id}', 'participation', 'negative', 1)" class="counter-btn gradient-btn-minus w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-lg mb-1">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="font-bold text-lg text-red-600">${student.counters.participation.negative}</span>
                            </div>
                        </div>
                    </td>
                    
                    <!-- Ø§Ù„Ù†Ø´Ø§Ø· -->
                    <td class="p-4 text-center table-counter-cell">
                        <div class="flex justify-center items-center space-x-4 space-x-reverse">
                            <div class="text-center">
                                <button onclick="updateCounter('${student.id}', 'activity', 'positive', 1)" class="counter-btn gradient-btn-plus w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-lg mb-1">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <span class="font-bold text-lg text-green-600">${student.counters.activity.positive}</span>
                            </div>
                            <div class="text-center">
                                <button onclick="updateCounter('${student.id}', 'activity', 'negative', 1)" class="counter-btn gradient-btn-minus w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-lg mb-1">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="font-bold text-lg text-red-600">${student.counters.activity.negative}</span>
                            </div>
                        </div>
                    </td>
                    
                    <td class="p-4 text-center">
                        <span class="positive-points px-3 py-2 rounded-full text-sm font-bold">${totalPositive}</span>
                    </td>
                    <td class="p-4 text-center">
                        <span class="negative-points px-3 py-2 rounded-full text-sm font-bold">${totalNegative}</span>
                    </td>
                    <td class="p-4 text-center">
                        <span class="performance-badge ${getPerformanceClass(student)}">${performance}</span>
                    </td>
                `;
                trackingTable.appendChild(row);
            });
        }

        function updateCounter(studentId, type, direction, value) {
            const student = currentUserData.students.find(s => s.id === studentId);
            if (!student) return;
            
            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ø¯Ø§Ø¯
            if (!student.counters[type]) {
                student.counters[type] = { positive: 0, negative: 0 };
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙŠÙ…Ø© Ù…Ø¹ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„Ù†Ø²ÙˆÙ„ ØªØ­Øª Ø§Ù„ØµÙØ±
            student.counters[type][direction] = Math.max(0, student.counters[type][direction] + value);
            
            autoSave();
            renderTrackingTable();
            updateStatistics();
            updateHallOfFame();
        }

        // Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function calculateTotalPositivePoints(student) {
            const hwWeight = currentUserData.userSettings.homeworkWeight || 1;
            const partWeight = currentUserData.userSettings.participationWeight || 1;
            const actWeight = currentUserData.userSettings.activityWeight || 1;
            
            return (student.counters.homework.positive * hwWeight) +
                   (student.counters.participation.positive * partWeight) +
                   (student.counters.activity.positive * actWeight);
        }

        function calculateTotalNegativePoints(student) {
            return student.counters.homework.negative +
                   student.counters.participation.negative +
                   student.counters.activity.negative;
        }

        function calculatePerformance(student) {
            const positive = calculateTotalPositivePoints(student);
            const negative = calculateTotalNegativePoints(student);
            const total = positive + negative;
            
            if (total === 0) return 'Ù„Ù… ÙŠØªÙ… Ø§Ù„ØªÙ‚ÙŠÙŠÙ…';
            
            const ratio = positive / total;
            
            if (ratio >= 0.9) return 'Ù…Ù…ØªØ§Ø²';
            if (ratio >= 0.75) return 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹';
            if (ratio >= 0.6) return 'Ø¬ÙŠØ¯';
            if (ratio >= 0.4) return 'Ù…ØªÙˆØ³Ø·';
            return 'Ø¶Ø¹ÙŠÙ';
        }

        function getPerformanceClass(student) {
            const performance = calculatePerformance(student);
            
            switch(performance) {
                case 'Ù…Ù…ØªØ§Ø²': return 'performance-excellent';
                case 'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§Ù‹': return 'performance-very-good';
                case 'Ø¬ÙŠØ¯': return 'performance-good';
                case 'Ù…ØªÙˆØ³Ø·': return 'performance-average';
                case 'Ø¶Ø¹ÙŠÙ': return 'performance-weak';
                default: return 'bg-gray-200 text-gray-700';
            }
        }

        function updateStatistics() {
            document.getElementById('totalStudents').textContent = currentUserData.students.length;
            document.getElementById('totalGroups').textContent = currentUserData.groups.length;
            
            let highestPositive = 0;
            let highestNegative = 0;
            
            currentUserData.students.forEach(student => {
                const positive = calculateTotalPositivePoints(student);
                const negative = calculateTotalNegativePoints(student);
                
                if (positive > highestPositive) highestPositive = positive;
                if (negative > highestNegative) highestNegative = negative;
            });
            
            document.getElementById('highestPositivePoints').textContent = highestPositive;
            document.getElementById('highestNegativePoints').textContent = highestNegative;
        }

        // Ù‚Ø§Ø¹Ø© Ø§Ù„Ø´Ø±Ù
        function updateHallOfFame() {
            // ÙØ±Ø² Ø§Ù„Ø·Ù„Ø§Ø¨ Ø­Ø³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©
            const rankedStudents = [...currentUserData.students].sort((a, b) => {
                const aPoints = calculateTotalPositivePoints(a);
                const bPoints = calculateTotalPositivePoints(b);
                return bPoints - aPoints;
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø±Ø§ÙƒØ² Ø§Ù„Ø£ÙˆÙ„Ù‰
            if (rankedStudents.length > 0) {
                const first = rankedStudents[0];
                document.getElementById('firstPlace').textContent = first.name;
                document.getElementById('firstPoints').textContent = `${calculateTotalPositivePoints(first)} Ù†Ù‚Ø·Ø©`;
                document.getElementById('firstGroup').textContent = first.groupName;
                document.getElementById('firstRatio').textContent = `${calculateAccuracy(first)}% Ø¯Ù‚Ø©`;
            }
            
            if (rankedStudents.length > 1) {
                const second = rankedStudents[1];
                document.getElementById('secondPlace').textContent = second.name;
                document.getElementById('secondPoints').textContent = `${calculateTotalPositivePoints(second)} Ù†Ù‚Ø·Ø©`;
                document.getElementById('secondGroup').textContent = second.groupName;
                document.getElementById('secondRatio').textContent = `${calculateAccuracy(second)}% Ø¯Ù‚Ø©`;
            }
            
            if (rankedStudents.length > 2) {
                const third = rankedStudents[2];
                document.getElementById('thirdPlace').textContent = third.name;
                document.getElementById('thirdPoints').textContent = `${calculateTotalPositivePoints(third)} Ù†Ù‚Ø·Ø©`;
                document.getElementById('thirdGroup').textContent = third.groupName;
                document.getElementById('thirdRatio').textContent = `${calculateAccuracy(third)}% Ø¯Ù‚Ø©`;
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªØµÙ†ÙŠÙ
            const rankingTable = document.getElementById('rankingTable');
            rankingTable.innerHTML = '';
            
            rankedStudents.forEach((student, index) => {
                const positive = calculateTotalPositivePoints(student);
                const negative = calculateTotalNegativePoints(student);
                const accuracy = calculateAccuracy(student);
                const performance = calculatePerformance(student);
                
                const row = document.createElement('tr');
                row.className = 'border-b hover:bg-gray-50';
                row.innerHTML = `
                    <td class="p-3 text-center">
                        <span class="font-bold">${index + 1}</span>
                    </td>
                    <td class="p-3">
                        <div class="flex items-center space-x-2 space-x-reverse">
                            <div class="student-avatar ${student.color}">
                                ${student.name.charAt(0)}
                            </div>
                            <span class="font-medium">${student.name}</span>
                        </div>
                    </td>
                    <td class="p-3">${student.groupName}</td>
                    <td class="p-3 text-center">
                        <span class="positive-points px-2 py-1 rounded-full text-xs font-bold">${positive}</span>
                    </td>
                    <td class="p-3 text-center">
                        <span class="negative-points px-2 py-1 rounded-full text-xs font-bold">${negative}</span>
                    </td>
                    <td class="p-3 text-center font-medium">${accuracy}%</td>
                    <td class="p-3 text-center">
                        <span class="performance-badge ${getPerformanceClass(student)}">${performance}</span>
                    </td>
                `;
                rankingTable.appendChild(row);
            });
        }

        function calculateAccuracy(student) {
            const positive = calculateTotalPositivePoints(student);
            const negative = calculateTotalNegativePoints(student);
            const total = positive + negative;
            
            if (total === 0) return 0;
            return Math.round((positive / total) * 100);
        }

        // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function showTab(tabName) {
            // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active-tab');
                btn.classList.add('text-gray-600', 'hover:text-[var(--primary-color)]');
            });
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø· Ù„Ù„Ø²Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            event.currentTarget.classList.add('active-tab');
            event.currentTarget.classList.remove('text-gray-600', 'hover:text-[var(--primary-color)]');
        }

        // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        function changeTheme(theme) {
            appData.settings.theme = theme;
            applyTheme();
            saveData();
        }

        function applyTheme() {
            document.body.className = `theme-${appData.settings.theme} bg-gray-50 min-h-screen`;
            
            if (appData.settings.darkMode) {
                document.body.classList.add('dark-mode');
                document.getElementById('darkModeToggle').checked = true;
            } else {
                document.body.classList.remove('dark-mode');
                document.getElementById('darkModeToggle').checked = false;
            }
        }

        function toggleDarkMode() {
            appData.settings.darkMode = !appData.settings.darkMode;
            applyTheme();
            saveData();
        }

        function loadWeights() {
            document.getElementById('homeworkWeight').value = currentUserData.userSettings.homeworkWeight || 1;
            document.getElementById('participationWeight').value = currentUserData.userSettings.participationWeight || 1;
            document.getElementById('activityWeight').value = currentUserData.userSettings.activityWeight || 1;
        }

        function saveWeights() {
            currentUserData.userSettings.homeworkWeight = parseInt(document.getElementById('homeworkWeight').value) || 1;
            currentUserData.userSettings.participationWeight = parseInt(document.getElementById('participationWeight').value) || 1;
            currentUserData.userSettings.activityWeight = parseInt(document.getElementById('activityWeight').value) || 1;
            
            autoSave();
            
            Swal.fire({
                icon: 'success',
                title: 'ØªÙ… Ø§Ù„Ø­ÙØ¸',
                text: 'ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø£ÙˆØ²Ø§Ù† Ø¨Ù†Ø¬Ø§Ø­',
                confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
            });
        }

        // Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function exportToExcel() {
            if (currentUserData.students.length === 0) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª',
                    text: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                return;
            }
            
            const data = currentUserData.students.map(student => {
                const positive = calculateTotalPositivePoints(student);
                const negative = calculateTotalNegativePoints(student);
                const accuracy = calculateAccuracy(student);
                const performance = calculatePerformance(student);
                
                return {
                    'Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨': student.name,
                    'Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©': student.groupName,
                    'Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª âœ“': student.counters.homework.positive,
                    'Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª âœ—': student.counters.homework.negative,
                    'Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© âœ“': student.counters.participation.positive,
                    'Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ© âœ—': student.counters.participation.negative,
                    'Ø§Ù„Ù†Ø´Ø§Ø· âœ“': student.counters.activity.positive,
                    'Ø§Ù„Ù†Ø´Ø§Ø· âœ—': student.counters.activity.negative,
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø· âœ“': positive,
                    'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø· âœ—': negative,
                    'Ø§Ù„Ø¯Ù‚Ø© %': accuracy,
                    'Ø§Ù„ØªÙ‚ÙŠÙŠÙ…': performance
                };
            });
            
            const worksheet = XLSX.utils.json_to_sheet(data);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Ø·Ù„Ø§Ø¨');
            XLSX.writeFile(workbook, 'Ø·Ù„Ø§Ø¨.xlsx');
        }

        function exportToPDF() {
            Swal.fire({
                icon: 'info',
                title: 'Ù‚Ø±ÙŠØ¨Ø§Ù‹',
                text: 'Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±',
                confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
            });
        }

        function importFromExcel() {
            Swal.fire({
                icon: 'info',
                title: 'Ù‚Ø±ÙŠØ¨Ø§Ù‹',
                text: 'Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±',
                confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
            });
        }

        function resetData() {
            Swal.fire({
                title: 'Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª',
                text: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Ù†Ø¹Ù…ØŒ Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„',
                cancelButtonText: 'Ø¥Ù„ØºØ§Ø¡',
                confirmButtonColor: '#EF4444'
            }).then((result) => {
                if (result.isConfirmed) {
                    currentUserData.groups = [];
                    currentUserData.students = [];
                    autoSave();
                    renderGroups();
                    renderTrackingTable();
                    updateStatistics();
                    updateHallOfFame();
                    
                    Swal.fire({
                        icon: 'success',
                        title: 'ØªÙ… Ø§Ù„Ù…Ø³Ø­',
                        text: 'ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­',
                        confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                    });
                }
            });
        }

        // ÙˆØ¸Ø§Ø¦Ù Ù…Ø³Ø§Ø¹Ø¯Ø©
        function updateDate() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('ar-SA', options);
        }

        function loadData() {
            const savedData = localStorage.getItem('studentTrackerData');
            if (savedData) {
                try {
                    const parsedData = JSON.parse(savedData);
                    appData = { ...appData, ...parsedData };
                    
                    // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
                    document.getElementById('darkModeToggle').checked = appData.settings.darkMode;
                    
                } catch (e) {
                    console.error('Error loading data:', e);
                }
            }
        }

        function saveData() {
            if (appData.currentUser) {
                appData.users[appData.currentUser] = currentUserData;
            }
            
            localStorage.setItem('studentTrackerData', JSON.stringify(appData));
        }

        function autoSave() {
            saveData();
        }

        // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø­Ø³Ù†Ø©
        function editStudent(studentId) {
            const student = currentUserData.students.find(s => s.id === studentId);
            if (!student) return;
            
            editingStudentId = studentId;
            currentEditStudentColor = student.color;
            
            document.getElementById('editStudentName').value = student.name;
            
            // ØªØ­Ø¯ÙŠØ« Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª
            const groupSelect = document.getElementById('editStudentGroup');
            groupSelect.innerHTML = '';
            
            currentUserData.groups.forEach(group => {
                const option = document.createElement('option');
                option.value = group.id;
                option.textContent = group.name;
                if (group.id === student.groupId) {
                    option.selected = true;
                }
                groupSelect.appendChild(option);
            });
            
            document.getElementById('editStudentModal').classList.remove('hidden');
        }

        function hideEditStudentModal() {
            document.getElementById('editStudentModal').classList.add('hidden');
            editingStudentId = null;
        }

        function setEditStudentColor(color) {
            currentEditStudentColor = color;
        }

        function saveStudentChanges() {
            if (!editingStudentId) return;
            
            const student = currentUserData.students.find(s => s.id === editingStudentId);
            if (!student) return;
            
            const newName = document.getElementById('editStudentName').value.trim();
            const newGroupId = document.getElementById('editStudentGroup').value;
            
            if (!newName) {
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                return;
            }
            
            if (!newGroupId) {
                Swal.fire({
                    icon: 'error',
                    title: 'Ø®Ø·Ø£',
                    text: 'ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¬Ù…ÙˆØ¹Ø© Ù„Ù„Ø·Ø§Ù„Ø¨',
                    confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                });
                return;
            }
            
            const group = currentUserData.groups.find(g => g.id === newGroupId);
            
            student.name = newName;
            student.groupId = newGroupId;
            student.groupName = group.name;
            student.color = currentEditStudentColor;
            
            autoSave();
            renderGroups();
            renderTrackingTable();
            updateHallOfFame();
            hideEditStudentModal();
            
            Swal.fire({
                icon: 'success',
                title: 'ØªÙ… Ø§Ù„ØªØ­Ø¯ÙŠØ«',
                text: 'ØªÙ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­',
                confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
            });
        }

        function resetStudentCounters() {
            if (!editingStudentId) return;
            
            Swal.fire({
                title: 'Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯',
                text: 'Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø¹Ø¯Ø§Ø¯ Ù‡Ø°Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ØŸ',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Ù†Ø¹Ù…ØŒ Ø£Ø¹ÙŠØ¯ Ø§Ù„ØªØ¹ÙŠÙŠÙ†',
                cancelButtonText: 'Ø¥Ù„ØºØ§Ø¡'
            }).then((result) => {
                if (result.isConfirmed) {
                    const student = currentUserData.students.find(s => s.id === editingStudentId);
                    if (student) {
                        student.counters = {
                            homework: { positive: 0, negative: 0 },
                            participation: { positive: 0, negative: 0 },
                            activity: { positive: 0, negative: 0 }
                        };
                        
                        autoSave();
                        renderTrackingTable();
                        updateStatistics();
                        updateHallOfFame();
                        
                        Swal.fire({
                            icon: 'success',
                            title: 'ØªÙ… Ø§Ù„ØªØ¹ÙŠÙŠÙ†',
                            text: 'ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¨Ù†Ø¬Ø§Ø­',
                            confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
                        });
                    }
                }
            });
        }

        function editGroup(groupId) {
            Swal.fire({
                icon: 'info',
                title: 'Ù‚Ø±ÙŠØ¨Ø§Ù‹',
                text: 'Ù…ÙŠØ²Ø© ØªØ­Ø±ÙŠØ± Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±',
                confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
            });
        }

        function showTodaySummary() {
            let totalPositive = 0;
            let totalNegative = 0;
            let activeStudents = 0;
            
            currentUserData.students.forEach(student => {
                const positive = calculateTotalPositivePoints(student);
                const negative = calculateTotalNegativePoints(student);
                
                if (positive > 0 || negative > 0) {
                    activeStudents++;
                }
                
                totalPositive += positive;
                totalNegative += negative;
            });
            
            Swal.fire({
                title: 'Ù…Ù„Ø®Øµ Ø§Ù„ÙŠÙˆÙ…',
                html: `
                    <div class="text-right space-y-3">
                        <div class="flex justify-between">
                            <span>Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù†Ø´Ø·ÙŠÙ†:</span>
                            <span class="font-bold">${activeStudents}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©:</span>
                            <span class="font-bold text-green-600">${totalPositive}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„Ø³Ù„Ø¨ÙŠØ©:</span>
                            <span class="font-bold text-red-600">${totalNegative}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­:</span>
                            <span class="font-bold ${totalPositive + totalNegative > 0 ? 'text-blue-600' : 'text-gray-600'}">
                                ${totalPositive + totalNegative > 0 ? Math.round((totalPositive / (totalPositive + totalNegative)) * 100) : 0}%
                            </span>
                        </div>
                    </div>
                `,
                icon: 'info',
                confirmButtonText: 'Ø­Ø³Ù†Ø§Ù‹'
            });
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        window.onload = initializeApp;
    </script>
</body>
</html>